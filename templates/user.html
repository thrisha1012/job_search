<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
        integrity="sha384-c6A4AA6HH7G7GT3dyzzUzqf+iWcViX3jzcIR+UO6hsL0piW2w5Kx22T1qrg/nG5f" crossorigin="anonymous">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }

        #banner-img {
            width: 1550px;
            height: 390px;
            image-rendering: crisp-edges;
            /* Improve image clarity */
            margin-top: 0px;
        }

        header {
            background-color: #e5e6ebd5;
            color: #fff;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header img {
            height: 50px;
        }

        nav {
            display: flex;
            align-items: center;
            justify-content: "space-between"
        }

        nav ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .user-icon {
            margin-left: 1250px;
            font-size: 25px;
        }

        .user-icon a {
            display: inline-block;
           
        }

        .white-icon {
            fill: rgb(6, 5, 5);
            width: 24px;
            height: 24px;
        }
        .custom-list {
    padding: 2px; /* Adjust the padding as needed */
}

.custom-list ul {
    list-style: none;
    padding: 2px;
}

.custom-list li {
    color: rgb(22, 21, 21);
    size: 20px;
}

.custom-list a {
    text-decoration: none;
    color: inherit;
}

.custom-list svg {
    fill: rgb(12, 12, 12); /* For SVG icons */
}

        #userDetailsContainer {
            position: fixed;
            top: 0;
            right: 0;
            width: 1000px;
            max-height: 100%;
            /* Set maximum height */
            background-color: #f9f9f9;
            z-index: 1000;
            overflow-y: auto;
            /* Make it scrollable */
            display: none;
            padding: 20px;
            /* Add padding for better readability */
        }



        #userDetailsContainer h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #060967;
        }

        .user-details-list {
            text-align: center;
            list-style-type: none;
            padding: 0;
        }

        .user-details-list li {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }

        .user-details-list li:hover {
            background-color: #e6e6e6;
            /* Slightly darker color on hover */
        }

        .detail-label {
            font-weight: bold;
            margin-right: 10px;
            color: #060967;
            flex-basis: 150px;
            text-align: right;
        }

        .detail-value {
            color: #555;
            flex-grow: 1;
        }


       

        main {
            padding: 20px;
            text-align: center;
            /* Align main content to the center */
           
        }

        .search-section {
            margin-bottom: 20px;

            padding: 30px;
            border-radius: 30px;
            text-align: center;
            
            /* Align the search box to the center */
        }

        .search-section h2 {
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 34px;
            font-family: "Brush Script MT";
            
        }

        .input-group {
            margin-bottom: 10px;
            display: inline-block;
            
        }

        .input-group label {
            font-size: 18px;
            margin-right: 10px;
        }

        .search-form {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            border: 2px solid #240404; /* Add border with a color */
            border-radius: 10px; /* Optional: Add border-radius for rounded corners */
           
        }

        .search-form input[type="text"],
        .search-form select,
        .search-form button {
            padding: 12px;
            border: 1px solid #000000;
            border-radius: 20px;
            margin-right: 10px;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .search-form button {
            background-color: #060967;
            color: #fff;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        .search-form button:hover {
            background-color: #100694;
        }

        .results-section {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        footer {
            background-color: #041249;
            color: #fff;
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
        }

        footer p {
            margin: 0;
            font-size: 14px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            /* Adjusted for responsiveness */
            gap: 20px;
            justify-content: flex-start;
        }

        .grid-item {
            width: 100%;
            max-width: 300px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            /* Added transition for smoother hover effect */
        }

        .grid-item:hover {
            transform: translateY(-5px);
            /* Lift the grid item slightly on hover */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            /* Increase shadow on hover */
        }



        .caption {
            margin-top: 10px;
            font-family: "Book Antiqua";
            font-size: 18px;
        }

        #searchForm {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            border: 2px solid #070000; /* Add border with a color */
            border-radius: 20px; /* Optional: Add border-radius for rounded corners */
            padding: 20px;
        }

        #searchForm input[type="text"],
        #searchForm select,
        #searchForm button {
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 20px;
            margin-right: 10px;
            margin-bottom: 5px;
            font-size: 16px;
        }

        #searchForm button {
            background-color: #060967;
            color: #fff;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        #searchForm button:hover {
            background-color: #100694;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            /* Adjusted for responsiveness */
            gap: 20px;
            justify-content: flex-start;
            
            /* Center the grid items horizontally */
        }

        .grid-item {
            width: 100%;
            /* Adjust the width of grid items */
            max-width: 300px;
            /* Maximum width of grid items */
        
            
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid #000000; /* Add border with a color */
            border-radius: 10px; /* Optional: Add border-radius for rounded corners */
            padding: 20px;
        }





        .grid-item:hover {
            background-color: #ebebee;
            transform: scale(1.05);
        }

        .grid-item h2 {
            margin-top: 0;
        }

        .grid-item p {
            margin-bottom: 5px;
        }

        .job-description {
            max-height: 180px;
            overflow-y: auto;
            position: relative;
        }

        .job-description .highlight {
            background-color: yellow;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .button {
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            transition: background-color 0.3s, transform 0.3s, border-radius 0.3s;
        }

        .button:hover {
            background-color: #8b8ef2;
            border-radius: 20px;
        }
       
    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 8px;
        text-align: center;
        border: 1px solid #ddd; /* Border color */
    }

    th {
        background-color: #f2f2f2; /* Header background color */
    }

    tr:nth-child(even) {
        background-color: #f2f2f2; /* Even row background color */
    }

    .modify-button {
        display: inline-block;
        background-color: #060967; /* Button background color */
        color: #fff; /* Button text color */
        padding: 10px 20px; /* Adjust padding for the button */
        text-decoration: none; /* Remove underline */
        border: none; /* Remove button border */
        border-radius: 5px; /* Add border radius for rounded corners */
        font-size: 16px; /* Adjust font size */
        cursor: pointer;
        transition: background-color 0.3s; /* Add smooth transition on hover */
    }

    .modify-button:hover {
        background-color: #100694; /* Change background color on hover */
    }

    </style>
</head>

<body>
    <header>
        <nav>
            <div class="custom-list">
                <ul>
                    <li class="user-icon"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="white-icon">
                        <path d="M12 12c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                    </svg></a>Profile</li>
                </ul>
            </div>
            
        </nav>
    </header>
    <img src="{{ url_for('static', filename='logo.jpg') }}" alt="BannerImage" id="banner-img">
    <div id="userDetailsContainer">
        <h2>Welcome, {{ user[1] }}</h2>
        <ul class="user-details-list">
            <li><span class="detail-label">Email:</span> <span class="detail-value">{{ user[2] }}</span></li>
            <li><span class="detail-label">Contact Number:</span> <span class="detail-value">{{ user[4] }}</span></li>
            <li><span class="detail-label">Address:</span> <span class="detail-value">{{ user[5] }}</span></li>
            <li><span class="detail-label">City:</span> <span class="detail-value">{{ user[6] }}</span></li>
            <li><span class="detail-label">Zipcode:</span> <span class="detail-value">{{ user[7] }}</span></li>
            <li><span class="detail-label">Job Title:</span> <span class="detail-value">{{ user[8] }}</span></li>
            <li><span class="detail-label">Industry:</span> <span class="detail-value">{{ user[9] }}</span></li>
            <li><span class="detail-label">Experience:</span> <span class="detail-value">{{ user[10] }}</span></li>
            <li><span class="detail-label">Education:</span> <span class="detail-value">{{ user[11] }}</span></li>
            <li><span class="detail-label">Skills:</span> <span class="detail-value">{{ user[12] }}</span></li>
            <li><span class="detail-label">Employment Type:</span> <span class="detail-value">{{ user[13] }}</span></li>
            <li><span class="detail-label">Salary Range:</span> <span class="detail-value">{{ user[14] }}</span></li>
            <li><span class="detail-label">Resume:</span> <span class="detail-value"><a
                        href="{{ url_for('view_resume', filename=user[15]) }}" target="_blank">Download
                        Resume</a></span></li>
            
            <li><span class="detail-label" style="text-align: center;">Saved Job</span></li>
            <table>
                <thead>
                    <tr>
                        <th>Company</th>
                        <th>Job Role</th>
                    </tr>
                </thead>
                <tbody>
                    {% for job in user_jobs %}
                    <tr>
                        <td>{{ job[1] }}</td>
                        <td>{{ job[2] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            

            <button>
                <li><a href="{{ url_for('modify') }}" class="modify-button">Modify</a></li>
            </button>


        </ul>

    </div>
    <main>
        <div class="container">

            <form id="searchForm" method="POST" action="/search">
                <label for="location" style="font-size:20px ;margin-right: 10px;">Location: </label>
                <input type="text" name="location" placeholder="Location">
                <label for="skills" style="font-size:20px ;margin-right: 10px;">Skills: </label>
                <input type="text" name="skills" placeholder="skills">
                <label for="Experience" style="font-size:20px ;margin-right: 10px;">Experience: </label>
                <input type="text" name="experience" placeholder="Experience">
                <button type="submit">Search</button>
            </form>
        </div>

        <main>
            <div class="container">
                <h2>Job Suggestions Based on Your Skills</h2>
                <div class="grid-container">
                    {% for company_detail in company_details %}
                    <div class="grid-item">
                        <h3>{{ company_detail.company }}</h3>
                        <p><strong>Job Title:</strong> {{ company_detail.jobtitle }}</p>
                        <p><strong>Experience Required:</strong> {{ company_detail.experience }}</p>
                        <p><strong>Location:</strong> {{ company_detail.joblocation_address }}</p>
                        <p class="job-description"><strong>Job Description:</strong> {{ company_detail.jobdescription }}
                        </p>
                        <div class="button-container">
                            <button type="button" class="button save" data-title="{{ company_detail.jobtitle }}"
                                data-company="{{ company_detail.company }}">Save</button>

                                <button type="submit" class="button apply" onclick="sendApplicationEmail()">Apply</button>

                            <button class="button view-company"
                                data-company="{{ company_detail.company }}">View</button>
                        </div>
                    </div>
                    {% if loop.index % 3 == 0 %}
                </div>
                <div class="grid-container">
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </main>

        
    </main>
    <footer>
        <p>&copy; 2024 Job Quest Portal. All rights reserved.</p>
    </footer>

    <script>
        
        // Function to toggle User Details Container
        function toggleUserDetails(event) {
            event.stopPropagation(); // Prevent event propagation
            console.log('Toggling User Details...');

            var userDetailsContainer = document.getElementById('userDetailsContainer');
            if (userDetailsContainer.style.display === 'none' || userDetailsContainer.style.display === '') {
                userDetailsContainer.style.display = 'block';
                // Add event listener to close the container when clicking outside or on user icon
                document.addEventListener('click', closeUserDetailsOnClickOutside);
            } else {
                userDetailsContainer.style.display = 'none';
                // Remove event listener when container is closed
                document.removeEventListener('click', closeUserDetailsOnClickOutside);
            }
        }

        // Function to close User Details Container when clicking outside or on user icon
        function closeUserDetailsOnClickOutside(event) {
            event.stopPropagation(); // Prevent event propagation
            console.log('Closing User Details...');

            var userDetailsContainer = document.getElementById('userDetailsContainer');
            var userIcon = document.querySelector('.user-icon a');

            // Check if clicked element is not the user details container or user icon
            if (!userDetailsContainer.contains(event.target) && event.target !== userIcon) {
                userDetailsContainer.style.display = 'none';
                // Remove event listener
                document.removeEventListener('click', closeUserDetailsOnClickOutside);
            }
        }

        // Attach click event to user icon
        var userIcon = document.querySelector('.user-icon a');
        if (userIcon) {
            userIcon.addEventListener('click', toggleUserDetails);
        } else {
            console.log('User icon not found');
        }

        function displayJobDetailsDropdown() {
            var dropdownList = document.getElementById('jobDetailsDropdown').querySelector('ul');
            dropdownList.style.display = 'block';
        }

        // Function to hide job details dropdown
        function hideJobDetailsDropdown() {
            var dropdownList = document.getElementById('jobDetailsDropdown').querySelector('ul');
            dropdownList.style.display = 'none';
        }

        // Attach mouseover and mouseout event listeners to "Job Details" label
        var jobDetailsLabel = document.querySelector('.detail-label');
        jobDetailsLabel.addEventListener('mouseover', displayJobDetailsDropdown);
        jobDetailsLabel.addEventListener('mouseout', hideJobDetailsDropdown);
        document.addEventListener('DOMContentLoaded', function () {
            const viewCompanyButtons = document.querySelectorAll('.view-company');
            viewCompanyButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const companyName = this.getAttribute('data-company');
                    fetchCompanyUrl(companyName, this); // Pass the button reference to enable/disable
                });
            });

            function fetchCompanyUrl(companyName, button) {
                button.disabled = true; // Disable the button while waiting for the response
                fetch('/get_company_url', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ company_name: companyName })
                })
                    .then(response => response.json())
                    .then(data => {
                        const companyUrl = data.company_url;
                        if (companyUrl) {
                            window.open(companyUrl, '_blank');
                        } else {
                            console.error('Error: Company URL not found.');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    })
                    .finally(() => {
                        button.disabled = false;
                    });
            }
        });

        

        function displayApplyModal(jobTitle, company, experience, jobLocation, jobDescription) {
            // Here you can implement your modal logic to display the apply form with the job details
            // You can populate the form fields with the job details passed as parameters
            // For example, you can use a Bootstrap modal or any other modal library
            // After populating the form, you can display the modal to the user
            console.log('Displaying apply modal with job details:', jobTitle, company, experience, jobLocation, jobDescription);
        }


        document.addEventListener('DOMContentLoaded', function () {
            const saveButtons = document.querySelectorAll('.button.save');
            saveButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const jobTitle = this.getAttribute('data-title');
                    const companyName = this.getAttribute('data-company');
                    saveJobDetails(jobTitle, companyName);
                });
            });
        });

        function saveJobDetails(jobTitle, companyName) {
            fetch('/save_job_details', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    jobTitle: jobTitle,
                    companyName: companyName
                })
            })
                .then(response => {
                    if (response.ok) {
                        alert('Job details saved successfully!');
                    } else {
                        alert('Failed to save job details.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
        function sendApplicationEmail(recipientEmail) {
    fetch('/send_application_email', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            recipient_email: recipientEmail
        })
    })
    .then(response => {
        if (response.ok) {
            alert('Application email sent successfully!');
        } else {
            alert('Failed to send application email.');
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
    </script>



</body>

</html>